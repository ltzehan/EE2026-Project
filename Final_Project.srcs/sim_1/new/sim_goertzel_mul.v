`timescale 1ns / 1ps
//////////////////////////////////////////////////////////////////////////////////
// Company: 
// Engineer: 
// 
// Create Date: 16.10.2022 17:57:13
// Design Name: 
// Module Name: sim_goertzel_mul
// Project Name: 
// Target Devices: 
// Tool Versions: 
// Description: 
// 
// Dependencies: 
// 
// Revision:
// Revision 0.01 - File Created
// Additional Comments:
// 
//////////////////////////////////////////////////////////////////////////////////

module sim_goertzel_mul(
    );
    
    // 100MHz clock
    reg CLK = 0;
    always begin
        #5 CLK <= ~CLK;
    end
    
    reg signed [60:0] a;
    reg signed [60:0] b;
    wire signed [60:0] y;
    goertzel_mul goertzel_mul(CLK, 1'b0, 1'b1, a, b, y); 
    
    initial begin
        // a = 251.76798041892653
        // b = -454.39664186607934
        // y = -114402.52483176503
        a = 61'b0000000000000000000000011111011110001001001101001011101010111;
        b = 61'b1111111111111111111111000111001100110100111010110101101110000;
        #10;
        $display("Expected = 1111111111111100100000100011101011110011010010010100000001000");
        $display("Actual   = %b", y);
        $display("Diff.    = %d", $signed(61'b1111111111111100100000100011101011110011010010010100000001000 - y));
        #10;
        
        // a = 1658.6949609541352
        // b = 156.6184272500259
        // y = 259782.19607217977
        a = 61'b0000000000000000000011001111010101100011110100011110110000010;
        b = 61'b0000000000000000000000010011100100111100101000100111111100011;
        #10;
        $display("Expected = 0000000000000111111011011000110001100100011000111001001010011");
        $display("Actual   = %b", y);
        $display("Diff.    = %d", $signed(61'b0000000000000111111011011000110001100100011000111001001010011 - y));
        #10;
        
        // a = 3503.757156035639
        // b = -236.74003920487485
        // y = -829479.6064842381
        a = 61'b0000000000000000000110110101111110000011101010011111010010110;
        b = 61'b1111111111111111111111100010011010000101000110011001010011011;
        #10;
        $display("Expected = 1111111111100110101011111011000011001001011110101110010111100");
        $display("Actual   = %b", y);
        $display("Diff.    = %d", $signed(61'b1111111111100110101011111011000011001001011110101110010111100 - y));
        #10;
        
        // a = -3971.4246066340993
        // b = -1722.2517933224126
        // y = 6839793.150820334
        a = 61'b1111111111111111111000001111100100100110100110011111010110011;
        b = 61'b1111111111111111111100101000101101111111000101001111001000011;
        #10;
        $display("Expected = 0000000011010000101110111110001001001101001110000101001010101");
        $display("Actual   = %b", y);
        $display("Diff.    = %d", $signed(61'b0000000011010000101110111110001001001101001110000101001010101 - y));
        #10;
        
        // a = 2885.166701176907
        // b = -2435.834211402367
        // y = -7027787.75632562
        a = 61'b0000000000000000000101101000101001010101010110011101101101001;
        b = 61'b1111111111111111111011001111100001010100111000100011111001000;
        #10;
        $display("Expected = 1111111100101001100001110110100001111100110000101110001101101");
        $display("Actual   = %b", y);
        $display("Diff.    = %d", $signed(61'b1111111100101001100001110110100001111100110000101110001101101 - y));
        #10;
        
        // a = 3824.7609972641185
        // b = -338.53793471108384
        // y = -1294826.6887773
        a = 61'b0000000000000000000111011110000110000101101000010110111011110;
        b = 61'b1111111111111111111111010101101011101100100100111101001001011;
        #10;
        $display("Expected = 1111111111011000011111000010101010011111010110001001010011110");
        $display("Actual   = %b", y);
        $display("Diff.    = %d", $signed(61'b1111111111011000011111000010101010011111010110001001010011110 - y));
        #10;
        
        // a = -1746.142721206019
        // b = -1612.545773985179
        // y = 2815735.0658557466
        a = 61'b1111111111111111111100100101101110110110111011010011111100000;
        b = 61'b1111111111111111111100110110011011101000100100000100111111110;
        #10;
        $display("Expected = 0000000001010101111011011110111000100001101101111101100000101");
        $display("Actual   = %b", y);
        $display("Diff.    = %d", $signed(61'b0000000001010101111011011110111000100001101101111101100000101 - y));
        #10;
        
        // a = -612.0769756586133
        // b = 2168.5336764143885
        // y = -1327309.5342735727
        a = 61'b1111111111111111111110110011011111011000100101101010010110000;
        b = 61'b0000000000000000000100001111000100010001001111100000100011110;
        #10;
        $display("Expected = 1111111111010111011111100110010011101110011100111011000111000");
        $display("Actual   = %b", y);
        $display("Diff.    = %d", $signed(61'b1111111111010111011111100110010011101110011100111011000111000 - y));
        #10;
        
        // a = 447.10897293527705
        // b = -423.3642996790495
        // y = -189289.97720696268
        a = 61'b0000000000000000000000110111111000110111110010110100110011110;
        b = 61'b1111111111111111111111001011000101000101011110101000001100111;
        #10;
        $display("Expected = 1111111111111010001110010010110000001011101010111000011101110");
        $display("Actual   = %b", y);
        $display("Diff.    = %d", $signed(61'b1111111111111010001110010010110000001011101010111000011101110 - y));
        #10;
    end
    
endmodule
